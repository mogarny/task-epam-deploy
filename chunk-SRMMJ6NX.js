import{Bb as S,Cb as W,Ga as _,Ia as P,Ja as m,La as M,Lb as y,Ma as t,Na as n,Oa as p,Qa as g,Va as r,W as C,Wa as d,Xa as h,a as f,ab as x,b as v,bb as O,ea as u,fa as b,va as a,wa as w}from"./chunk-B6X6O6YF.js";var z=()=>({img:!0});function j(l,o){if(l&1&&(t(0,"tr")(1,"td"),r(2),n(),t(3,"td"),u(),t(4,"svg",8)(5,"g"),p(6,"path",9),n()()(),b(),t(7,"td"),p(8,"div"),r(9),n(),t(10,"td"),r(11),n(),t(12,"td"),r(13),n()()),l&2){let e=o.$implicit;a(2),d(e.id),a(2),M("img"),m("ngClass",O(8,z)),a(2),P("stroke",e.color),a(3),h(" ",e.name," "),a(2),d(e.wins),a(2),d(e.time)}}var E=class l{constructor(o){this.service=o;this.page=this.service.getPageWinners()}page=1;limit=10;totalCount=0;winners=[];cars=[];objects=[];fetchWinners(o){this.service.getWinners(this.page,o).subscribe({next:e=>{if(this.winners=e.body,this.totalCount=Number(e.headers.get("x-total-count")),this.winners&&this.winners.length>0){let s=this.winners.map(i=>i.id);this.service.fetchCarsByIds(s).subscribe({next:i=>{this.cars=i.body,this.objects=this.combine(this.winners,this.cars)}})}},error:e=>{throw new Error(`Error fetching cars: ${e}`)}})}combine(o,e){let s=[];for(let i=0;i<e.length;i+=1){let c=o.find(I=>I.id===e[i].id);s.push(v(f({},c),{color:e[i].color,name:e[i].name}))}return e.length===0&&(this.winners=[],this.totalCount=0),s.sort((i,c)=>i.time!==c.time?i.time-c.time:c.wins-i.wins),s}get lastPage(){return this.totalCount===0?1:Math.ceil(this.totalCount/this.limit)}nextPage(){this.page+=1,this.fetchWinners(this.limit),this.service.setPageWinners(this.page)}previousPage(){this.page-=1,this.fetchWinners(this.limit),this.service.setPageWinners(this.page)}ngOnInit(){this.fetchWinners(this.limit),typeof window<"u"&&(this.page=this.service.getPageWinners())}ngOnDestroy(){this.service.setPageWinners(this.page)}static \u0275fac=function(e){return new(e||l)(w(y))};static \u0275cmp=C({type:l,selectors:[["app-winner"]],standalone:!0,features:[x],decls:27,vars:4,consts:[[1,"winners-page","dotted-font"],[1,"title"],[1,"table-container"],[1,"winners-table"],[1,"dotted-font"],[4,"ngFor","ngForOf"],[1,"pagination"],[3,"click","disabled"],["version","1.1","xmlns","http://www.w3.org/2000/svg","viewBox","0 0 256 256",0,"xml","space","preserve",3,"ngClass"],["stroke-width","3","fill-opacity","0","d",`M157.5,10h-59c-15.6,0-28.3,17.4-28.3,33v174.6c0,15.6,12.7,28.3,28.3,28.3h59
            c15.6,0,28.3-12.7,28.3-28.3V43C185.8,27.4,173.1,10,157.5,10z M180.9,81.2v58.5l-13.7,1.8v-24.1L180.9,81.2z M173.7,64.1
            c-5.1,19.6-11.1,42.7-11.1,42.7H93.4L82.3,64.1C82.3,64.1,126.9,48.9,173.7,64.1z M89,118.9v22.5l-13.7-1.8v-57L89,118.9z
            M75.3,200.4v-52l13.7,1.7v41.1L75.3,200.4z M83.1,215.2l11.1-16.7h69.1l11.1,16.7H83.1z M167.2,189.7v-39.5l13.7-1.8v50.4
            L167.2,189.7z`]],template:function(e,s){e&1&&(t(0,"div",0)(1,"span",1),r(2,"Winners"),n(),t(3,"div",2)(4,"table",3)(5,"thead")(6,"tr")(7,"th"),r(8,"\u2116"),n(),t(9,"th"),r(10,"Car"),n(),t(11,"th"),r(12,"Name"),n(),t(13,"th"),r(14,"Wins"),n(),t(15,"th"),r(16,"Best Time (Seconds)"),n()()(),t(17,"tbody",4),_(18,j,14,9,"tr",5),n()()(),t(19,"div",6),r(20,"Page 1"),n(),t(21,"div")(22,"button",7),g("click",function(){return s.previousPage()}),r(23,"<"),n(),r(24),t(25,"button",7),g("click",function(){return s.nextPage()}),r(26," > "),n()()()),e&2&&(a(18),m("ngForOf",s.objects),a(4),m("disabled",s.page===1),a(2),h(" PAGE #",s.page," "),a(),m("disabled",s.lastPage===s.page))},dependencies:[W,S],styles:["body[_ngcontent-%COMP%]{font-family:Arial,sans-serif;color:#fff;margin:0;display:flex;justify-content:center;align-items:center}.winners-page[_ngcontent-%COMP%]{width:90%;max-width:800px;margin:0 auto}.winners-page[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-bottom:20px;font-size:32px;color:#e7c9ce}.winners-page[_ngcontent-%COMP%]   .winners-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;text-align:left}.winners-page[_ngcontent-%COMP%]   .winners-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{vertical-align:middle}.winners-page[_ngcontent-%COMP%]   .winners-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:10px}.winners-page[_ngcontent-%COMP%]   .winners-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px;border-bottom:1px solid #4b4b6f}.img[_ngcontent-%COMP%]{transform:rotate(-270deg)}"]})};export{E as WinnersComponent};
